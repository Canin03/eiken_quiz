<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±æ¤œ3ç´š è‹±å˜èªã‚¯ã‚¤ã‚ºï¼ˆã‚°ãƒ©ãƒ•è¡¨ç¤ºä¿®æ­£ç‰ˆï¼‰</title>
    
    <!-- â–¼â–¼â–¼ ãƒ›ãƒ¼ãƒ ç”»é¢ã‚¢ã‚¤ã‚³ãƒ³ç”¨ã®è¨­å®š â–¼â–¼â–¼ -->
    <meta name="apple-mobile-web-app-title" content="è‹±å˜èªã‚¯ã‚¤ã‚º">
    <link rel="apple-touch-icon" href="https://placehold.co/180x180/86efac/15803d?text=ğŸ¦‰3">
    <link rel="icon" type="image/png" sizes="192x192" href="https://placehold.co/192x192/86efac/15803d?text=ğŸ¦‰3">
    <link rel="icon" type="image/png" sizes="512x512" href="https://placehold.co/512x512/86efac/15803d?text=ğŸ¦‰3">
    <!-- â–²â–²â–² ãƒ›ãƒ¼ãƒ ç”»é¢ã‚¢ã‚¤ã‚³ãƒ³ç”¨ã®è¨­å®š â–²â–²â–² -->

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Inter', 'Noto Sans JP', sans-serif; }
        .quiz-container { margin: 2rem auto; padding: 2rem; background-color: #f9fafb; border-radius: 0.75rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .option-button { transition: background-color 0.3s ease, transform 0.1s ease; }
        .option-button:hover:not(:disabled) { transform: translateY(-2px); background-color: #e5e7eb; }
        .option-button.correct { background-color: #10b981; color: white; border-color: #059669; }
        .option-button.incorrect { background-color: #ef4444; color: white; border-color: #dc2626; }
        .option-button:disabled { opacity: 0.8; cursor: not-allowed; }
        .feedback-message { min-height: 2.25rem; }
        .japanese-text { font-family: 'Noto Sans JP', sans-serif; }
        #speakButton { display: none; background-color: #8b5cf6; color: white; padding: 0.5rem 1rem; border-radius: 0.5rem; margin-top: 0.5rem; transition: background-color 0.3s ease; }
        #speakButton:hover { background-color: #7c3aed; }
        #exampleSentenceArea { display: none; margin-top: 1rem; padding: 1rem; background-color: #eef2ff; border-left: 4px solid #6366f1; border-radius: 0.375rem; }
        #exampleSentenceArea p { margin-bottom: 0.5rem; }
        #exampleSentenceArea .example-en { font-weight: 500; color: #4338ca; font-size: 1.125rem; }
        #exampleSentenceArea .example-ja { font-size: 1rem; color: #4f46e5; }
        #graphDisplayArea { margin-top: 1.5rem; padding: 1.5rem; background-color: #fff; border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06); }
        .action-buttons-container { display: flex; flex-direction: column; gap: 0.75rem; margin-top: 1.5rem; text-align: center; }
        #targetScoreSettingArea { margin-top: 1rem; padding: 1rem; background-color: #f3f4f6; border-radius: 0.5rem; text-align: center; }
        #targetScoreSelect { width: 120px; padding: 0.5rem; border-radius: 0.375rem; border: 1px solid #d1d5db; text-align: center; margin: 0 0.5rem; }
        #saveTargetButton { background-color: #2563eb; color: white; }
        #saveTargetButton:hover { background-color: #1d4ed8; }
        #currentTargetDisplay, #mainMenuTargetDisplay { margin-top: 0.5rem; font-size: 0.875rem; color: #4b5563; }
        .score-display { font-size: 1.25rem; font-weight: 600; }
        #cumulativeScoreDisplay { color: #059669; /* green-600 */ }
        #monthlyTotalScoreDisplay { color: #4f46e5; /* indigo-600 */ }
        
        @media (min-width: 640px) { .action-buttons-container { flex-direction: row; justify-content: center; } .action-buttons-container button { width: auto; } }
        .missed-word { color: #ef4444; /* red-500 */ }
        #endOfMonthMessage { color: #d97706; /* amber-600 */ font-weight: 600; }
    </style>
</head>
<body class="bg-gray-100 px-4 py-8 flex items-center justify-center min-h-screen">
    <div class="quiz-container w-full max-w-5xl mx-auto">
        
        <div id="mainMenu" class="text-center">
            <div class="flex justify-center items-center gap-x-3 mb-4">
                <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                    <div class="text-3xl">ğŸ¦‰</div>
                </div>
                <h1 class="text-3xl font-bold text-gray-800 japanese-text">è‹±æ¤œ3ç´š è‹±å˜èªã‚¯ã‚¤ã‚º</h1>
            </div>

            <div id="targetScoreSettingArea" class="my-6">
                <label for="targetScoreSelect" class="japanese-text font-medium text-gray-700">ç´¯è¨ˆç›®æ¨™ã‚¹ã‚³ã‚¢:</label>
                <select id="targetScoreSelect" class="w-auto p-2 border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-base mx-2">
                    <option value="0">æœªè¨­å®š</option>
                    <option value="120">120ç‚¹</option>
                    <option value="150">150ç‚¹</option>
                    <option value="200">200ç‚¹</option>
                    <option value="250">250ç‚¹</option>
                    <option value="300">300ç‚¹</option>
                    <option value="400">400ç‚¹</option>
                    <option value="500">500ç‚¹</option>
                </select>
                <button id="saveTargetButton" class="font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out japanese-text">ç›®æ¨™ã‚’è¨­å®š</button>
                <p id="mainMenuTargetDisplay" class="japanese-text"></p>
            </div>
            
            <p id="endOfMonthMessage" class="text-lg my-4 japanese-text" style="display: none;"></p>
            <p id="motivationalMessage" class="text-lg text-gray-600 my-8 px-4 japanese-text"></p>
            
            <button id="startQuizButton" class="bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-8 rounded-full shadow-lg transform hover:scale-105 transition-transform duration-300 ease-in-out japanese-text text-xl">
                ã‚¯ã‚¤ã‚ºã‚’ã¯ã˜ã‚ã‚‹
            </button>
             <button id="mainMenuToggleGraphButton" class="mt-8 bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out japanese-text">
                é€²æ—ã‚°ãƒ©ãƒ•ã‚’è¦‹ã‚‹
            </button>
        </div>

        <div id="app-container" style="display: none;">
             <header class="mb-4 text-center">
                <button id="backToMenuButton" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out japanese-text">
                    ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹
                </button>
            </header>

            <div id="graphDisplayArea" style="display: none;">
                <h2 class="text-xl font-semibold text-gray-700 mb-3 japanese-text text-center">å­¦ç¿’é€²æ—ã‚°ãƒ©ãƒ•</h2>
                <canvas id="progressChart"></canvas>
                <p class="text-xs text-gray-500 mt-2 text-center japanese-text">éå»æœ€å¤§10æ—¥é–“ã®æ—¥åˆ¥æœ€é«˜ã‚¹ã‚³ã‚¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
            </div>

            <div id="quizAndResultContainer" class="mt-6">
                <div id="quizArea" style="display: none;">
                    <div id="progressArea" class="flex justify-between items-center mb-4">
                        <p id="questionNumber" class="text-xl font-semibold text-indigo-600 japanese-text"></p>
                        <p id="score" class="text-xl font-semibold text-green-600 japanese-text">ã‚¹ã‚³ã‚¢: 0</p>
                    </div>

                    <div id="wordDisplay" class="text-center p-6 bg-white rounded-lg shadow">
                        <p id="word" class="text-4xl font-bold text-gray-700 japanese-text"></p>
                        <p id="instructionText" class="text-sm text-gray-500 mt-2 japanese-text"></p>
                        <button id="speakButton">  ç™ºéŸ³ã‚’èã</button>
                    </div>

                    <div id="interactionArea" class="mt-6">
                        <div id="options" class="grid grid-cols-1 sm:grid-cols-2 gap-4"></div>
                        <div id="typingArea" class="space-y-3" style="display: none;">
                             <input type="text" id="typingInput" placeholder="è‹±èªã®ã‚¹ãƒšãƒ«ã‚’å…¥åŠ›" lang="en" class="w-full p-3 border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg" autocapitalize="off" autocorrect="off" spellcheck="false">
                             <button id="submitTypingAnswerButton" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out japanese-text">è§£ç­”ã™ã‚‹</button>
                        </div>
                    </div>

                    <div id="feedback" class="feedback-message text-center text-2xl font-semibold mt-4 japanese-text">
                    </div>

                    <div id="exampleSentenceArea">
                        <p class="font-semibold japanese-text">ä¾‹æ–‡:</p>
                        <p id="exampleEn" class="example-en"></p>
                        <p id="exampleJa" class="example-ja japanese-text"></p>
                    </div>
                    
                    <div class="action-buttons-container">
                        <button id="quitQuizButton" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out w-full japanese-text" style="display: none;">ã‚¯ã‚¤ã‚ºã‚’çµ‚äº†ã™ã‚‹</button>
                        <button id="nextButton" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out w-full japanese-text" style="display: none;">æ¬¡ã®å•é¡Œã¸</button>
                    </div>
                </div>

                <div id="resultArea" class="text-center py-8" style="display: none;">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4 japanese-text">ã‚¯ã‚¤ã‚ºçµ‚äº†ï¼</h2>
                    <p id="finalScore" class="text-3xl font-semibold text-indigo-600 mb-2"></p>
                    <div class="space-y-2 mb-4">
                        <p id="cumulativeScoreDisplay" class="score-display"></p>
                        <p id="monthlyTotalScoreDisplay" class="score-display"></p>
                    </div>
                    <p id="yakinikuMessage" class="text-2xl font-bold text-amber-500 my-4" style="display: none;"></p>
                    <p id="resultMessage" class="text-lg text-gray-700 mb-6 japanese-text"></p>
                    <button id="restartButton" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out japanese-text">ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            const wordList = [
                { word: "ã§ãã‚‹", choices: ["able", "about", "above", "abroad"], answer: "able", example: { en: "Are you able to swim?", ja: "ã‚ãªãŸã¯æ³³ãã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ" } },
                { word: "ï½ã«ã¤ã„ã¦ï¼›ãŠã‚ˆã", choices: ["about", "above", "abroad", "across"], answer: "about", example: { en: "Let's talk about your plan.", ja: "ã‚ãªãŸã®è¨ˆç”»ã«ã¤ã„ã¦è©±ã—ã¾ã—ã‚‡ã†ã€‚" } },
                { word: "ï½ã®ä¸Šã«", choices: ["above", "abroad", "across", "action"], answer: "above", example: { en: "The plane is flying above the clouds.", ja: "é£›è¡Œæ©ŸãŒé›²ã®ä¸Šã‚’é£›ã‚“ã§ã„ã¾ã™ã€‚" } },
                { word: "æµ·å¤–ã¸", choices: ["abroad", "across", "action", "activity"], answer: "abroad", example: { en: "I want to study abroad someday.", ja: "ã„ã¤ã‹æµ·å¤–ã«ç•™å­¦ã—ãŸã„ã§ã™ã€‚" } },
                { word: "ï½ã‚’æ¨ªåˆ‡ã£ã¦", choices: ["across", "action", "activity", "actor"], answer: "across", example: { en: "He swam across the river.", ja: "å½¼ã¯å·ã‚’æ³³ã„ã§æ¸¡ã£ãŸã€‚" } },
                { word: "è¡Œå‹•", choices: ["action", "activity", "actor", "address"], answer: "action", example: { en: "We need to take immediate action.", ja: "ç§ãŸã¡ã¯ã™ãã«è¡Œå‹•ã‚’èµ·ã“ã™å¿…è¦ãŒã‚ã‚‹ã€‚" } },
                { word: "æ´»å‹•", choices: ["activity", "actor", "address", "adult"], answer: "activity", example: { en: "She enjoys outdoor activities.", ja: "å½¼å¥³ã¯é‡å¤–æ´»å‹•ã‚’æ¥½ã—ã‚“ã§ã„ã‚‹ã€‚" } },
                { word: "ä¿³å„ª", choices: ["actor", "address", "adult", "advice"], answer: "actor", example: { en: "He is a famous movie actor.", ja: "å½¼ã¯æœ‰åãªæ˜ ç”»ä¿³å„ªã§ã™ã€‚" } },
                { word: "ä½æ‰€", choices: ["address", "adult", "advice", "after"], answer: "address", example: { en: "Please write down your name and address.", ja: "ã‚ãªãŸã®åå‰ã¨ä½æ‰€ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚" } },
                { word: "å¤§äºº", choices: ["adult", "advice", "after", "again"], answer: "adult", example: { en: "This movie is for adults only.", ja: "ã“ã®æ˜ ç”»ã¯å¤§äººå‘ã‘ã§ã™ã€‚" } },
                { word: "åŠ©è¨€", choices: ["advice", "after", "again", "age"], answer: "advice", example: { en: "Thank you for your good advice.", ja: "è‰¯ã„åŠ©è¨€ã‚’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚" } },
                { word: "ï½ã®å¾Œã§", choices: ["after", "again", "age", "ago"], answer: "after", example: { en: "Let's meet after school.", ja: "æ”¾èª²å¾Œã«ä¼šã„ã¾ã—ã‚‡ã†ã€‚" } },
                { word: "å†ã³", choices: ["again", "age", "ago", "agree"], answer: "again", example: { en: "Please say that again.", ja: "ã‚‚ã†ä¸€åº¦ãã‚Œã‚’è¨€ã£ã¦ãã ã•ã„ã€‚" } },
                { word: "å¹´é½¢", choices: ["age", "ago", "agree", "air"], answer: "age", example: { en: "What is your age?", ja: "ã‚ãªãŸã¯ä½•æ­³ã§ã™ã‹ï¼Ÿ" } },
                { word: "ï½å‰ã«", choices: ["ago", "agree", "air", "airport"], answer: "ago", example: { en: "I met him three years ago.", ja: "ç§ã¯3å¹´å‰ã«å½¼ã«ä¼šã„ã¾ã—ãŸã€‚" } },
                { word: "åŒæ„ã™ã‚‹", choices: ["agree", "air", "airport", "album"], answer: "agree", example: { en: "I agree with your idea.", ja: "ã‚ãªãŸã®è€ƒãˆã«åŒæ„ã—ã¾ã™ã€‚" } },
                { word: "ç©ºæ°—", choices: ["air", "airport", "album", "all"], answer: "air", example: { en: "The air is clean in the mountains.", ja: "å±±ã®ç©ºæ°—ã¯ãã‚Œã„ã§ã™ã€‚" } 